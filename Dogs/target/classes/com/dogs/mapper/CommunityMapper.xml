<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.dogs.mapper.CommunityMapper">

  <!-- 커뮤니티 글 등록 -->
  <insert id="enroll">
  	insert into dogCommu(bno, title, comcontent, writer)
  	values (bno_seq.nextval, #{title}, #{comContent}, #{writer})
  </insert>
  
  <!-- 커뮤니티 글 목록 -->
  <select id="getList" resultType="com.dogs.model.CommunityVO">
  	select * from dogCommu
  </select>
  
  <!-- 커뮤니티 글 목록(페이징) -->
	<select id="getListPaging" resultType="com.dogs.model.CommunityVO">
	  <![CDATA[
	    select bno, title, writer, comcontent, comcatecode, regdate, updatedate from (
	      select /*+INDEC_DESC(dogCommu pk_commu) */ rownum as rn, bno, title, writer, comcontent, comcatecode, regdate, updatedate
	      from dogCommu where rownum <= #{pageNum}*#{amount}
	  ]]>
	  	<if test="keyword != null">
	  		and title like '%'||#{keyword}||'%'
	  	</if>
	  
	  <![CDATA[
	  		)
	  	where rn > (#{pageNum} - 1) * #{amount}
	  ]]>
	</select>
  
  <!-- 커뮤니티 글 조회 -->
  <select id="getPage" resultType="com.dogs.model.CommunityVO">
  	select * from dogCommu where bno = #{bno}
  </select>
  
  <!-- 커뮤니티 수정 -->
  <update id="modify">
  	update dogCommu set title = #{title}, comContent = #{comContent}, updateDate = sysdate where bno = #{bno}
  </update>
  
  <!-- 커뮤니티 삭제 -->
  <delete id="delete">
  	delete from dogCommu where bno = #{bno}
  </delete>
  
  <!-- 커뮤니티 총 개수 -->
  <select id="getTotal" resultType="int">
  	select count(*) from dogCommu
  	
  	<if test="keyword != null">
	 	where title like '%'||#{keyword}||'%'
	</if>
  </select>
  
</mapper>